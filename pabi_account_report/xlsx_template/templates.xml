<?xml version="1.0" encoding="UTF-8"?>
<openerp>
    <data>
        <!-- Directory for Account XLSX Reports -->
        <record model="document.directory" id="dir_account_reports">
            <field name="name">Account Reports</field>
            <field name="parent_id" ref="document.dir_root"/>
            <field name="user_id" ref="base.user_root"/>
            <field name="ressource_id">0</field>
            <field name="group_ids" eval="[(4, ref('base.group_user'))]"/>
        </record>

        # Input Tax Report
        <record id="xlsx_report_input_tax" model="ir.attachment">
            <field name="res_model">xlsx.report.input.tax</field>
            <field name="datas"></field>
            <field name="datas_fname">xlsx_report_input_tax.xlsx</field>
            <field name="name">Input Tax Report</field>
            <field name="parent_id" eval="ref('dir_account_reports')"/>
            <field name="description">
                {
                    '__EXPORT__': {
                        'Input Tax Report': {
                            '_HEAD_': {
                                'A1': '${env.user.with_context(lang="en_US").company_id.partner_id.name}',
                                'B3': 'calendar_period_id.calendar_name${value or ""}',
                                'B4': 'taxbranch_id${value and value.with_context(lang="th_TH").name or ""}',
                                'B5': '${env.user.with_context(lang="th_TH").display_name}',
                                'B6': '${time.strftime("%d/%m/%Y")}#{number_format=date}',
                            },
                            'results': {
                                'A10': 'tax_sequence_display${value or ""}',
                                'B10': 'invoice_date${value or ""}#{number_format=date}',
                                'C10': 'invoice_number${value or ""}',
                                'D10': 'partner_id${value and " ".join(list(filter(lambda l: l != False, [value.with_context(lang="th_TH").title.name, value.with_context(lang="th_TH").name]))) or ""}',
                                'E10': 'partner_id.vat${value or ""}',
                                'F10': 'partner_id.taxbranch${value and (value == "00000" and "Head Office" or value) or ""}',
                                'G10': 'base${value or ""}#{number_format=number}',
                                'H10': 'amount${value or ""}#{number_format=number}',
                                'I10': 'move_number${value or ""}',
                            },
                            '_TAIL_0': {
                                'A10': '${"Total"}#{font=bold}',
                                'G10': '@{sum}#{font=bold;align=right;number_format=number}',
                                'H10': '@{sum}#{font=bold;align=right;number_format=number}',
                            }
                        }
                    }
                }
            </field>
        </record>

        # Partner Detail
        <record id="xlsx_report_partner_detail" model="ir.attachment">
            <field name="res_model">xlsx.report.partner.detail</field>
            <field name="datas"></field>
            <field name="datas_fname">xlsx_report_partner_detail.xlsx</field>
            <field name="name">Partner Detail</field>
            <field name="parent_id" eval="ref('dir_account_reports')"/>
            <field name="description">
                {
                    '__EXPORT__': {
                        'Partner Detail Report': {
                            '_HEAD_': {
                                'A1': '${env.user.with_context(lang="en_US").company_id.partner_id.name}',
                                'B3': 'partner_type${value and dict(customer="Customer", supplier="Supplier", customer_and_supplier="Customer and Supplier", customer_or_supplier="Customer or Supplier")[value] or ""}',
                                'B4': 'active${value and dict(true="True", false="False")[value] or ""}',
                                'B5': 'category_ids${value and ", ".join([x.name for x in value]) or ""}',
                                'B6': 'partner_ids${value and ", ".join([" ".join(list(filter(lambda l: l != False, [x.with_context(lang="th_TH").title.name, x.with_context(lang="th_TH").name]))) for x in value]) or ""}',
                                'B7': '${env.user.with_context(lang="th_TH").display_name}',
                                'B8': '${time.strftime("%d/%m/%Y")}#{number_format=date}',
                            },
                            'partner_detail_results': {
                                'A11': 'search_key${value or ""}',
                                'B11': 'id${value and " ".join(list(filter(lambda l: l != False, [env["res.partner"].browse(value).with_context(lang="th_TH").title.name, env["res.partner"].browse(value).with_context(lang="th_TH").name]))) or ""}',
                                'C11': 'customer${value and "X" or ""}',
                                'D11': 'supplier${value and "X" or ""}',
                                'E11': 'category_id.name${value or ""}',
                                'F11': 'tag_ids${value and ", ".join([x.name for x in value]) or ""}',
                                'G11': 'street${value or ""}',
                                'H11': 'street2${value or ""}',
                                'I11': 'township_id.name${value or ""}',
                                'J11': 'district_id.name${value or ""}',
                                'K11': 'province_id.name${value or ""}',
                                'L11': 'country_id.name${value or ""}',
                                'M11': 'zip${value or ""}',
                                'N11': 'vat${value or ""}',
                                'O11': 'taxbranch${value or ""}',
                                'P11': 'mobile${value or ""}',
                                'Q11': 'fax${value or ""}',
                                'R11': 'website${value or ""}',
                                'S11': 'email${value or ""}',
                                'T11': 'comment${value or ""}',
                                'U11': 'property_account_payable.code${value or ""}',
                                'V11': 'property_account_payable.name${value or ""}',
                                'W11': 'property_account_receivable.code${value or ""}',
                                'X11': 'property_account_receivable.name${value or ""}',
                                'Y11': 'property_supplier_payment_term.name${value or ""}',
                                'Z11': 'property_payment_term.name${value or ""}',
                                'AA11': 'bank_ids${value and (value.filtered(lambda l: l.default is True) and value.filtered(lambda l: l.default is True)[0].acc_number or "") or ""}',
                                'AB11': 'bank_ids${value and (value.filtered(lambda l: l.default is True) and " ".join(filter(lambda x: x != False, [value.with_context(lang="th_TH").filtered(lambda l: l.default is True)[0].bank.name, value.with_context(lang="th_TH").filtered(lambda l: l.default is True)[0].bank_branch.name])) or "") or ""}',
                                'AC11': 'bank_ids${value and (value.filtered(lambda l: l.default is True) and " ".join(filter(lambda x: x != False, [value.with_context(lang="th_TH").filtered(lambda l: l.default is True)[0].partner_id.title.name, value.with_context(lang="th_TH").filtered(lambda l: l.default is True)[0].partner_id.name])) or "") or ""}',
                                'AD11': 'bank_ids${value and (value.filtered(lambda l: l.default is True) and (value.filtered(lambda l: l.default is True)[0].active is True and "X" or "") or "") or ""}',
                                'AE11': 'bank_ids${value and (value.filtered(lambda l: l.default is True) and (value.filtered(lambda l: l.default is True)[0].default is True and "X" or "")) or ""}',
                                'AF11': 'income_tax_form${value and dict(pnd1="PND1", pnd3="PND3", pnd3a="PND3a", pnd53="PND53")[value] or ""}',
                                'AG11': 'create_date${value or ""}#{number_format=date}',
                                'AH11': 'create_uid${value and value.with_context(lang="th_TH").display_name or ""}',
                                'AI11': 'write_date${value or ""}#{number_format=date}',
                                'AJ11': 'write_uid${value and value.with_context(lang="th_TH").display_name or ""}',
                                'AK11': 'active${value and "X" or ""}',
                            },
                        },
                        'Partner Bank Account Detail Report': {
                            '_HEAD_': {
                                'A1': '${env.user.with_context(lang="en_US").company_id.partner_id.name}',
                                'B3': 'partner_type${value and dict(customer="Customer", supplier="Supplier", customer_and_supplier="Customer and Supplier", customer_or_supplier="Customer or Supplier")[value] or ""}',
                                'B4': 'active${value and dict(true="True", false="False")[value] or ""}',
                                'B5': 'category_ids${value and ", ".join([x.name for x in value]) or ""}',
                                'B6': 'partner_ids${value and ", ".join([" ".join(list(filter(lambda l: l != False, [x.with_context(lang="th_TH").title.name, x.with_context(lang="th_TH").name]))) for x in value]) or ""}',
                                'B7': '${env.user.with_context(lang="th_TH").display_name}',
                                'B8': '${time.strftime("%d/%m/%Y")}#{number_format=date}',
                            },
                            'partner_bank_account_detail_results': {
                                'A11': 'partner_id.search_key${value or ""}',
                                'B11': 'partner_id${value and " ".join(list(filter(lambda l: l != False, [value.with_context(lang="th_TH").title.name, value.with_context(lang="th_TH").name]))) or ""}',
                                'C11': 'bank_id.acc_number${value or ""}',
                                'D11': 'bank_id${value and " ".join(list(filter(lambda l: l != False, [value.with_context(lang="th_TH").bank.name, value.with_context(lang="th_TH").bank_branch.name]))) or ""}',
                                'E11': 'bank_id.partner_id${value and " ".join(list(filter(lambda l: l != False, [value.with_context(lang="th_TH").title.name, value.with_context(lang="th_TH").name]))) or ""}',
                                'F11': 'bank_id${value and (value.active is True and "X" or "") or ""}',
                                'G11': 'bank_id${value and (value.default is True and "X" or "") or ""}',
                            },
                        },
                    }
                }
            </field>
        </record>

        # Advance Status
        <record id="xlsx_report_advance_status" model="ir.attachment">
            <field name="res_model">xlsx.report.advance.status</field>
            <field name="datas"></field>
            <field name="datas_fname">xlsx_report_advance_status.xlsx</field>
            <field name="name">Advance Status</field>
            <field name="parent_id" eval="ref('dir_account_reports')"/>
            <field name="description">
              {
                '__EXPORT__': {
                    'Advance Status Report': {
                        '_HEAD_': {
                            'A1': '${env.user.company_id.display_name}',
                            'B3': '${date.today()}#{number_format=date}',
                            'B4': '${env.user.display_name}',
                            'B5': '${time.strftime("%d/%m/%Y")}',
                        },
                        'results': {
                            'A8': 'operating_unit_id.name${value or ""}',
                            'B8': 'number${value or ""}',
                            'C8': 'invoice_id.number${value or ""}',
                            'D8': 'remark${value or ""}',
                            'E8': 'invoice_id.date_invoice#{number_format=date}',
                            'F8': 'date_due#{number_format=date}',
                            'G8': 'employee_id.employee_code${value or ""}',
                            'H8': 'employee_id${value and value.first_name + " " + value.last_name or ""}',
                            'I8': 'amount_advanced${value or 0.0}',
                            'J8': 'days_diff${value or 0}',
                            'K8': 'amount_clearing_0${value or 0.0}',
                            'L8': 'amount_clearing_1${value or 0.0}',
                            'M8': 'amount_clearing_2${value or 0.0}',
                            'N8': 'amount_clearing_3${value or 0.0}',
                            'O8': 'amount_to_clearing${value or 0.0}',
                        }
                    },
                    'Summary': {
                        '_HEAD_': {
                            'A1': '${env.user.company_id.display_name}',
                            'B3': '${date.today()}#{number_format=date}',
                            'B4': '${env.user.display_name}',
                            'B5': '${time.strftime("%d/%m/%Y")}',
                        },
                        '_BI_': {
                            'A8': {
                                'df': 'Advance Status Report',
                                # Group by A and add Subtotal (so we use pivot)
                                # By scripting, we need result = ...
                                'oper_code': """
df = df[["A", "K", "L", "M", "N", "O"]]
groupby = ["A"]
sum_cols = ["K", "L", "M", "N", "O"]
result = pd.pivot_table(df, index=groupby,
                      values=sum_cols,
                      aggfunc=np.sum,
                      fill_value=0,
                      margins=True,
                      margins_name="Total")
                                """,
                            },
                        },
                    },
                    'Detailed Summary': {
                        '_HEAD_': {
                            'A1': '${env.user.company_id.display_name}',
                            'B3': '${date.today()}#{number_format=date}',
                            'B4': '${env.user.display_name}',
                            'B5': '${time.strftime("%d/%m/%Y")}',
                        },
                        '_BI_': {
                            'A8': {
                                'df': 'Advance Status Report',
                                # Group by A, H. User will have to do subtotal themselves
                                'oper_code': 'df[["A", "H", "K", "L", "M", "N", "O"]].groupby(["A", "H"]).sum()',
                            },
                        },
                    },
                }
            }
          </field>
        </record>

        # Cheque Register
        <record id="xlsx_report_cheque_register" model="ir.attachment">
            <field name="res_model">xlsx.report.cheque.register</field>
            <field name="datas"></field>
            <field name="datas_fname">xlsx_report_cheque_register.xlsx</field>
            <field name="name">Cheque Register</field>
            <field name="parent_id" eval="ref('dir_account_reports')"/>
            <field name="description">
                {
                    '__EXPORT__': {
                        'Cheque Register Report': {
                            '_HEAD_': {
                                'A1': '${env.user.with_context(lang="en_US").company_id.partner_id.name}',
                                'B3': 'date_cheque_received${value or ""}#{number_format=date}',
                                'B4': 'cheque_lot_ids${value and ", ".join([x.name for x in value]) or ""}',
                                'B5': 'number_cheque_from${value or ""}',
                                'D5': 'number_cheque_to${value or ""}',
                                'B6': 'journal_ids${value and ", ".join([x.default_credit_account_id.code for x in value]) or ""}',
                                'B7': '${env.user.with_context(lang="th_TH").display_name}',
                                'B8': '${time.strftime("%d/%m/%Y")}#{number_format=date}',
                            },
                            'results': {
                                'A11': 'cheque_lot_id.journal_id.default_credit_account_id.code${value or ""}#{align=left}',
                                'B11': 'cheque_lot_id.journal_id.default_credit_account_id.name${value or ""}',
                                'C11': 'voucher_id.partner_id.search_key${value or ""}',
                                'D11': 'voucher_id.partner_id${value and " ".join(list(filter(lambda l: l != False, [value.with_context(lang="th_TH").title.name, value.with_context(lang="th_TH").name]))) or ""}',
                                'E11': 'cheque_lot_id.name${value or ""}',
                                'F11': 'number${value or ""}',
                                'G11': 'voucher_id.number${value or ""}',
                                'H11': 'voucher_id.date${value or ""}#{number_format=date}',
                                'I11': 'amount${value or ""}#{number_format=number}',
                                'J11': 'voucher_id.date_cheque_received${value or ""}#{number_format=date}',
                                'K11': 'voucher_id.move_ids${value and (value.mapped("match_import_id") and value.mapped("match_import_id").date_value or "") or ""}#{number_format=date}',
                                'L11': 'date_void${value or ""}#{number_format=date}',
                                'M11': 'payment_export_id.user_id${value and value.with_context(lang="th_TH").display_name or ""}',
                            },
                            '_TAIL_0': {
                                'A11': '${"Total"}#{font=bold}',
                                'I11': '@{sum}#{font=bold;number_format=number;align=right}',
                            }
                        }
                    }
                }
            </field>
        </record>

        # Contract Collateral
        <record id="xlsx_report_contract_collateral" model="ir.attachment">
            <field name="res_model">xlsx.report.contract.collateral</field>
            <field name="datas"></field>
            <field name="datas_fname">xlsx_report_contract_collateral.xlsx</field>
            <field name="name">Contract Collateral</field>
            <field name="parent_id" eval="ref('dir_account_reports')"/>
            <field name="description">
                {
                    '__EXPORT__': {
                        'Contract Collateral Report': {
                            '_HEAD_': {
                                'A1': '${env.user.with_context(lang="en_US").company_id.partner_id.name}',
                                'B3': 'date_report${value or ""}#{number_format=date}',
                                'B4': 'partner_ids${value and ", ".join([" ".join(list(filter(lambda l: l != False, [x.with_context(lang="th_TH").title.name, x.with_context(lang="th_TH").name]))) for x in value]) or ""}',
                                'B5': '${env.user.with_context(lang="th_TH").display_name}',
                                'B6': '${time.strftime("%d/%m/%Y")}#{number_format=date}',
                            },
                            'results': {
                                'A9': 'operating_unit_id${value and (value.org_id and value.org_id.name_short or "") or ""}',
                                'B9': 'supplier_id.search_key${value or ""}',
                                'C9': 'supplier_id${value and " ".join(list(filter(lambda l: l != False, [value.with_context(lang="th_TH").title.name, value.with_context(lang="th_TH").name]))) or ""}',
                                'D9': 'name${value or ""}',
                                'E9': 'requisition_id.purchase_ids${value and (value.mapped("order_id").filtered(lambda l: l.state == "done") and value.mapped("order_id").filtered(lambda l: l.state == "done")[0].name or "") or ""}',
                                'F9': 'poc_code${value or ""}',
                                'G9': 'start_date${value or ""}#{number_format=date}',
                                'H9': 'end_date${value or ""}#{number_format=date}',
                                'I9': 'collateral_type_id.name${value or ""}',
                                'J9': 'collateral_no${value or ""}',
                                'K9': 'collateral_date${value or ""}#{number_format=date}',
                                'L9': 'bank${value or ""}',
                                'M9': 'branch${value or ""}',
                                'N9': 'currency_id.name${value or ""}',
                                'O9': 'collateral_agreement_amt${value or ""}#{number_format=number}',
                                'P9': 'collateral_due_date${value or ""}#{number_format=date}',
                                'Q9': "${'=B3-?(P9)'}",
                                'R9': "${'=IF(?(Q9)&lt;=0,?(O9),\"\")'}",
                                'S9': "${'=IF(AND(?(Q9)&gt;=1,?(Q9)&lt;=30),?(O9),\"\")'}",
                                'T9': "${'=IF(AND(?(Q9)&gt;=31,?(Q9)&lt;=60),?(O9),\"\")'}",
                                'U9': "${'=IF(AND(?(Q9)&gt;=61,?(Q9)&lt;=90),?(O9),\"\")'}",
                                'V9': "${'=IF(AND(?(Q9)&gt;=91,?(Q9)&lt;=180),?(O9),\"\")'}",
                                'W9': "${'=IF(AND(?(Q9)&gt;=181,?(Q9)&lt;=365),?(O9),\"\")'}",
                                'X9': "${'=IF(AND(?(Q9)&gt;=366,?(Q9)&lt;=1095),?(O9),\"\")'}",
                                'Y9': "${'=IF(?(Q9)&gt;1095,?(O9),\"\")'}",
                            },
                            '_TAIL_0': {
                                'A9': '${"Total"}#{font=bold}',
                                'O9': '@{sum}#{font=bold;number_format=number}',
                                'R9': '@{sum}#{font=bold;number_format=number}',
                                'S9': '@{sum}#{font=bold;number_format=number}',
                                'T9': '@{sum}#{font=bold;number_format=number}',
                                'U9': '@{sum}#{font=bold;number_format=number}',
                                'V9': '@{sum}#{font=bold;number_format=number}',
                                'W9': '@{sum}#{font=bold;number_format=number}',
                                'X9': '@{sum}#{font=bold;number_format=number}',
                                'Y9': '@{sum}#{font=bold;number_format=number}',
                            }
                        }
                    }
                }
            </field>
        </record>

        # Advance Payment
        <record id="xlsx_report_advance_payment" model="ir.attachment">
            <field name="res_model">xlsx.report.advance.payment</field>
            <field name="datas"></field>
            <field name="datas_fname">xlsx_report_advance_payment.xlsx</field>
            <field name="name">Advance Payment</field>
            <field name="parent_id" eval="ref('dir_account_reports')"/>
            <field name="description">
                {
                    '__EXPORT__': {
                        'Advance Payment Report': {
                            '_HEAD_': {
                                'A1': '${env.user.with_context(lang="en_US").company_id.partner_id.name}',
                                'B3': 'account_ids${value and ", ".join([x.code for x in value]) or ""}',
                                'B4': 'date_report${value or ""}#{number_format=date}',
                                'B5': '${env.user.with_context(lang="th_TH").display_name}',
                                'B6': '${time.strftime("%d/%m/%Y")}#{number_format=date}',
                            },
                            'results': {
                                'A9': 'org_id.name_short${value or ""}',
                                'B9': 'invoice_id.partner_id.search_key${value or ""}',
                                'C9': 'invoice_id.partner_id${value and " ".join(list(filter(lambda l: l != False, [value.title_lang, value.with_context(lang="th_TH").name]))) or ""}',
                                'D9': 'invoice_id.source_document_id${value and value.name or ""}',
                                'E9': 'invoice_id.source_document_id${value and value.contract_id.display_code or ""}',
                                'F9': 'invoice_id.partner_id.category_id${value and value.name or ""}',
                                'G9': 'invoice_id.number${value or ""}',
                                'H9': 'invoice_id.date_document${value or ""}#{number_format=date}',
                                'I9': 'invoice_id.date_invoice${value or ""}#{number_format=date}',
                                'J9': 'invoice_id.move_ids${value and value.filtered(lambda l: l.account_id == 199).name or ""}',
                                'K9': 'balance${value or ""}#{number_format=number}',
                                'L9': 'invoice_id.payment_ids${value and ", ".join([x.move_id.name for x in value.filtered(lambda l: l.doctype == "payment")]) or ""}',
                                'M9': 'invoice_id.payment_ids${value and ", ".join([x.move_id.date for x in value.filtered(lambda l: l.doctype == "payment")]) or ""}#{number_format=date}',
                                'N9': "${'=?(M9)+IF(?(F9)=\"ต่างประเทศ\",60,18)'}",
                                'O9': "${'=B4-?(N9)'}",
                                'P9': "${'=IF(?(O9)&lt;=0,?(K9),\"\")'}#{number_format=number}",
                                'Q9': "${'=IF(AND(?(O9)&gt;=1,?(O9)&lt;=30),?(K9),\"\")'}#{number_format=number}",
                                'R9': "${'=IF(AND(?(O9)&gt;=31,?(O9)&lt;=60),?(K9),\"\")'}#{number_format=number}",
                                'S9': "${'=IF(AND(?(O9)&gt;=61,?(O9)&lt;=90),?(K9),\"\")'}#{number_format=number}",
                                'T9': "${'=IF(AND(?(O9)&gt;=91,?(O9)&lt;=180),?(K9),\"\")'}#{number_format=number}",
                                'U9': "${'=IF(AND(?(O9)&gt;=181,?(O9)&lt;=365),?(K9),\"\")'}#{number_format=number}",
                                'V9': "${'=IF(AND(?(O9)&gt;365),?(K9),\"\")'}#{number_format=number}",
                            },
                            '_GROUPBY_results["org_id"]': {  # groupby
                                'K9': '@{sum}#{font=bold;number_format=number}',
                            },
                        }
                    }
                }
            </field>
        </record>

        # Payable Detail
        <record id="xlsx_report_payable_detail" model="ir.attachment">
            <field name="res_model">xlsx.report.payable.detail</field>
            <field name="datas"></field>
            <field name="datas_fname">xlsx_report_payable_detail.xlsx</field>
            <field name="name">Payable Detail</field>
            <field name="parent_id" eval="ref('dir_account_reports')"/>
            <field name="description">
                {
                    '__EXPORT__': {
                        'Payable Detail Report': {
                            '_HEAD_': {
                                'A1': '${env.user.with_context(lang="en_US").company_id.partner_id.name}',
                                'B3': 'account_ids${value and ", ".join([x.code for x in value]) or ""}',
                                'B4': 'partner_ids${value and ", ".join([" ".join(list(filter(lambda l: l != False, [x.with_context(lang="th_TH").title.name, x.with_context(lang="th_TH").name]))) for x in value]) or ""}',
                                'B5': 'fiscalyear_start_id.name${value or ""}',
                                'D5': 'fiscalyear_end_id.name${value or ""}',
                                'B6': 'filter${value and dict(filter_no="No Filters", filter_date="Dates", filter_period="Periods", filter_as_of_date="As of Date")[value] or ""}',
                                'B7': 'period_start_id.name${value or ""}',
                                'D7': 'period_end_id.name${value or ""}',
                                'B8': 'date_start${value or ""}#{number_format=date}',
                                'D8': 'date_end${value or ""}#{number_format=date}',
                                'B9': 'as_of_date${value or ""}#{number_format=date}',
                                'B10': 'period_length_days${value or ""}',
                                'B11': 'move_ids${value and ", ".join([x.name for x in value]) or ""}',
                                'B12': '${env.user.with_context(lang="th_TH").display_name}',
                                'B13': '${time.strftime("%d/%m/%Y")}#{number_format=date}',
                                'AH1': 'date_start_real${value or ""}#{number_format=date}',
                                'AH2': 'date_end_real${value or ""}#{number_format=date}',
                                'AH6': 'period_length_days${value}',
                                'AH7': 'period_length_days${value * 2}',
                                'AH8': 'period_length_days${value * 3}',
                                'AH9': 'period_length_days${value * 4}',
                            },
                            'results': {
                                'A16': 'invoice_move_line_id.partner_id.search_key${value or ""}',
                                'B16': 'invoice_move_line_id.partner_id${value and " ".join(list(filter(lambda l: l != False, [value.with_context(lang="th_TH").title.name, value.with_context(lang="th_TH").name]))) or ""}',
                                'C16': 'invoice_move_line_id.invoice.supplier_invoice_number${value or ""}',
                                'D16': 'invoice_move_line_id.invoice.purchase_billing_id.name${value or ""}',
                                'E16': 'invoice_move_line_id.move_id.name${value or ""}',
                                'F16': 'invoice_move_line_id${value and value.invoice.date_document or value.move_id.create_date}#{number_format=date}',
                                'G16': 'invoice_move_line_id.period_id.fiscalyear_id.name${value or ""}',
                                'H16': 'invoice_move_line_id.period_id.name${value or ""}',
                                'I16': 'invoice_move_line_id.move_id.date${value or ""}#{number_format=date}',
                                'J16': 'invoice_move_line_id.invoice.date_due${value or ""}#{number_format=date}',
                                'K16': "${'=IF(AND(?(J16)&lt;&gt;\"\",AH2&lt;&gt;\"\"),AH2-?(J16),\"\")'}",
                                'L16': "${'=IF(?(K16)&lt;&gt;\"\",IF(?(K16)&lt;=0,\"Not Due\",IF(AND(?(K16)&gt;=1,?(K16)&lt;=AH6),1&amp;\"-\"&amp;AH6&amp;\" Days\",IF(AND(?(K16)&gt;=AH6+1,?(K16)&lt;=AH7),AH6+1&amp;\"-\"&amp;AH7&amp;\" Days\",IF(AND(?(K16)&gt;=AH7+1,?(K16)&lt;=AH8),AH7+1&amp;\"-\"&amp;AH8&amp;\" Days\",IF(AND(?(K16)&gt;=AH8+1,?(K16)&lt;=AH9),AH8+1&amp;\"-\"&amp;AH9&amp;\" Days\",IF(?(K16)&gt;AH9,\"Over \"&amp;AH9&amp;\" Days\",\"\")))))),\"\")'}",
                                'M16': 'invoice_move_line_id.invoice.source_document_id${value and (value._name in ("purchase.order", "sale.order") and value.name or value.number) or ""}',
                                'N16': 'invoice_move_line_id.invoice.source_document_id${value and value._name == "purchase.order" and value.sudo().contract_id.display_code or ""}',
                                'O16': 'invoice_move_line_id.invoice.amount_untaxed${value or ""}#{number_format=number}',
                                'P16': 'invoice_move_line_id.invoice.amount_tax${value or ""}#{number_format=number}',
                                'Q16': 'invoice_move_line_id${value and value.credit - value.debit or ""}#{number_format=number}',
                                'R16': 'invoice_move_line_id.currency_id.name${value or "THB"}',
                                'S16': 'invoice_move_line_id.invoice.tax_line${value and ", ".join(list(filter(lambda l: l != False, [x.tax_code_id.code for x in value]))) or ""}',
                                'T16': 'invoice_move_line_id.move_id.narration${value or ""}',
                                'U16': 'payment_move_line_id.move_id.document_id${value and value._name == "account.voucher" and value.number or ""}',
                                'V16': 'payment_move_line_id${value and value.debit - value.credit or ""}#{number_format=number}',
                                'W16': 'payment_move_line_id.move_id.document_id${value and value._name == "account.voucher" and (value.payment_type == "transfer" and dict(direct="DIRECT", smart="SMART", oversea="Oversea")[value.transfer_type] or "Cheque") or ""}',
                                'X16': 'payment_move_line_id.move_id.document_id${value and value._name == "account.voucher" and env["payment.export.line"].search([("voucher_id", "=", value.id)]).mapped("export_id").filtered(lambda l: l.state == "done").name or ""}',
                                'Y16': 'payment_move_line_id.move_id.document_id${value and value._name == "account.voucher" and value.number_cheque or ""}',
                                'Z16': 'payment_move_line_id.move_id.document_id${value and value._name == "account.voucher" and value.income_tax_form and dict(pnd1="PND1", pnd3="PND3", pnd3a="PND3a", pnd53="PND53")[value.income_tax_form] or ""}',
                                'AA16': 'id${value and env["payable.detail.view"].browse(value).payment_move_line_id.move_id.document_id and env["payable.detail.view"].browse(value).payment_move_line_id.move_id.document_id._name == "account.voucher" and env["payable.detail.view"].browse(value).payment_move_line_id.move_id.document_id.tax_line_wht.filtered(lambda l: l.invoice_id.id == env["account.invoice"].search([("move_id", "=", env["payable.detail.view"].browse(value).invoice_move_line_id.move_id.id)]).id).amount or ""}',
                                'AB16': 'invoice_move_line_id.move_id.write_uid${value and value.with_context(lang="th_TH").display_name or ""}',
                                'AC16': 'invoice_move_line_id.invoice.state${value and dict(draft="Draft", proforma="Pro-forma", proforma2="Pro-forma", open="Open", paid="Paid", cancel="Cancelled")[value] or ""}',
                            },
                            '_TAIL_0': {
                                'A16': '${"Total"}#{font=bold}',
                                'O16': '@{sum}#{font=bold;align=right;number_format=number}',
                                'P16': '@{sum}#{font=bold;align=right;number_format=number}',
                                'Q16': '@{sum}#{font=bold;align=right;number_format=number}',
                                'V16': '@{sum}#{font=bold;align=right;number_format=number}',
                                'AA16': '@{sum}#{font=bold;align=right;number_format=number}',
                            }
                        }
                    }
                }
            </field>
        </record>

        # Payable Balance
        <record id="xlsx_report_payable_balance" model="ir.attachment">
            <field name="res_model">xlsx.report.payable.balance</field>
            <field name="datas"></field>
            <field name="datas_fname">xlsx_report_payable_balance.xlsx</field>
            <field name="name">Payable Balance</field>
            <field name="parent_id" eval="ref('dir_account_reports')"/>
            <field name="description">
                {
                    '__EXPORT__': {
                        'Payable Balance Report': {
                            '_HEAD_': {
                                'A1': '${env.user.with_context(lang="en_US").company_id.partner_id.name}',
                                'B3': 'account_ids${value and ", ".join([x.code for x in value]) or ""}',
                                'B4': 'partner_ids${value and ", ".join([" ".join(list(filter(lambda l: l != False, [x.with_context(lang="th_TH").title.name, x.with_context(lang="th_TH").name]))) for x in value]) or ""}',
                                'B5': 'fiscalyear_start_id.name${value or ""}',
                                'D5': 'fiscalyear_end_id.name${value or ""}',
                                'B6': 'filter${value and dict(filter_no="No Filters", filter_date="Dates", filter_period="Periods")[value] or ""}',
                                'B7': 'period_start_id.name${value or ""}',
                                'D7': 'period_end_id.name${value or ""}',
                                'B8': 'date_start${value or ""}#{number_format=date}',
                                'D8': 'date_end${value or ""}#{number_format=date}',
                                'B9': '${env.user.with_context(lang="th_TH").display_name}',
                                'B10': '${time.strftime("%d/%m/%Y")}#{number_format=date}',
                            },
                            'results': {
                                'A13': 'account_id.code${value or ""}',
                                'B13': 'partner_id.search_key${value or ""}',
                                'C13': 'partner_id${value and " ".join(list(filter(lambda l: l != False, [value.with_context(lang="th_TH").title.name, value.with_context(lang="th_TH").name]))) or ""}',
                                'D13': 'partner_id${value and " ".join(list(filter(lambda l: l != False, [value.street, value.street2, value.township_id.name, value.district_id.name, value.province_id.name, value.zip]))) or ""}',
                                'E13': 'move_id.name${value or ""}',
                                'F13': 'move_id.id${value and env["account.invoice"].search([("move_id", "=", value)]).supplier_invoice_number or ""}',
                                'G13': 'move_id.date${value or ""}#{number_format=date}',
                                'H13': 'move_id.narration${value or ""}',
                                'I13': 'id${value and (env["account.move.line"].browse(value).credit - env["account.move.line"].browse(value).debit) or ""}#{number_format=number}',
                                'J13': 'id${value and (env["account.move.line"].browse(value).reconcile_partial_id != "" and sum(list(env["account.move.line"].browse(value).reconcile_partial_id.line_partial_ids.mapped("credit"))) - sum(list(env["account.move.line"].browse(value).reconcile_partial_id.line_partial_ids.mapped("debit"))) or (env["account.move.line"].browse(value).credit - env["account.move.line"].browse(value).debit)) or ""}#{number_format=number}',
                            },
                            '_TAIL_0': {
                                'A13': '${"Total"}#{font=bold}',
                                'I13': '@{sum}#{font=bold;number_format=number}',
                                'J13': '@{sum}#{font=bold;number_format=number}',
                            }
                        }
                    }
                }
            </field>
        </record>

        # Purchase Billing
        <record id="xlsx_report_purchase_billing" model="ir.attachment">
            <field name="res_model">xlsx.report.purchase.billing</field>
            <field name="datas"></field>
            <field name="datas_fname">xlsx_report_purchase_billing.xlsx</field>
            <field name="name">Purchase Billing</field>
            <field name="parent_id" eval="ref('dir_account_reports')"/>
            <field name="description">
                {
                    '__EXPORT__': {
                        'Purchase Billing Report': {
                            '_HEAD_': {
                                'A1': '${env.user.with_context(lang="en_US").company_id.partner_id.name}',
                                'B3': 'date_billing_start${value or ""}#{number_format=date}',
                                'D3': 'date_billing_end${value or ""}#{number_format=date}',
                                'B4': 'date_due_billing_start${value or ""}#{number_format=date}',
                                'D4': 'date_due_billing_end${value or ""}#{number_format=date}',
                                'B5': 'partner_ids${value and ", ".join([" ".join(list(filter(lambda l: l != False, [x.with_context(lang="th_TH").title.name, x.with_context(lang="th_TH").name]))) for x in value]) or ""}',
                                'B6': 'billing_ids${value and ", ".join([x.name for x in value]) or ""}',
                                'B7': '${env.user.with_context(lang="th_TH").display_name}',
                                'B8': '${time.strftime("%d/%m/%Y")}#{number_format=date}',
                            },
                            'results': {
                                'A11': 'billing_id.name${value or ""}',
                                'B11': 'billing_id.date${value or ""}#{number_format=date}',
                                'C11': 'billing_id.date_due${value or ""}#{number_format=date}',
                                'D11': 'billing_id.date_sent${value or ""}#{number_format=date}',
                                'E11': 'invoice_id.partner_id.search_key${value or ""}',
                                'F11': 'invoice_id.partner_id${value and " ".join(list(filter(lambda l: l != False, [value.with_context(lang="th_TH").title.name, value.with_context(lang="th_TH").name]))) or ""}',
                                'G11': 'invoice_id.source_document_id${value and (value._table in ("purchase_order", "sale_order") and value.name or value.number or "")  or ""}',
                                'H11': 'invoice_id.source_document_id${value and ((value._table == "purchase_order" and value.contract_id) and value.sudo().contract_id.display_code or "") or ""}',
                                'I11': 'invoice_id.source_document_id${value and (value._table == "purchase_order" and value.notes or "") or ""}',
                                'J11': 'invoice_id.supplier_invoice_number${value or ""}',
                                'K11': 'invoice_id.amount_total${value or ""}#{number_format=number}',
                                'L11': 'invoice_id.number${value or ""}',
                                'M11': 'invoice_id.date_invoice${value or ""}#{number_format=date}',
                                'N11': 'invoice_id.date_due${value or ""}#{number_format=date}',
                                'O11': 'invoice_id.date_receipt_billing${value or ""}#{number_format=date}',
                                'P11': 'invoice_id.purchase_billing_id.user_id${value and value.with_context(lang="th_TH").display_name or ""}',
                                'Q11': 'invoice_id.state${value and dict(draft="Draft", proforma="Pro-forma", proforma2="Pro-forma", open="Open", paid="Paid", cancel="Cancelled")[value] or ""}',
                            },
                            '_TAIL_0': {
                                'J11': '${"Total"}#{font=bold;align=right}',
                                'K11': '@{sum}#{font=bold;number_format=number;align=right}',
                            }
                        }
                    }
                }
            </field>
        </record>

        # SLA Purchase
        <record id="xlsx_report_sla_purchase" model="ir.attachment">
            <field name="res_model">xlsx.report.sla.purchase</field>
            <field name="datas"></field>
            <field name="datas_fname">xlsx_report_sla_purchase.xlsx</field>
            <field name="name">SLA Purchase</field>
            <field name="parent_id" eval="ref('dir_account_reports')"/>
            <field name="description">
                {
                    '__EXPORT__': {
                        'SLA Purchase Report': {
                            '_HEAD_': {
                                'A1': '${env.user.with_context(lang="en_US").company_id.partner_id.name}',
                                'B3': 'fiscalyear_start_id.name${value or ""}',
                                'D3': 'fiscalyear_end_id.name${value or ""}',
                                'B4': 'filter${value and dict(filter_no="No Filters", filter_date="Dates", filter_period="Periods")[value] or ""}',
                                'B5': 'period_start_id.name${value or ""}',
                                'D5': 'period_end_id.name${value or ""}',
                                'B6': 'date_start${value or ""}#{number_format=date}',
                                'D6': 'date_end${value or ""}#{number_format=date}',
                                'B7': 'user_ids${value and ", ".join([x.with_context(lang="th_TH").display_name for x in value]) or ""}',
                                'B8': 'source_document_type${value or ""}',
                                'B9': '${env.user.with_context(lang="th_TH").display_name}',
                                'B10': '${time.strftime("%d/%m/%Y")}#{number_format=date}',
                            },
                            'results': {
                                'A13': 'voucher_id.period_id.fiscalyear_id.name${value or ""}',
                                'B13': 'voucher_id.number${value or ""}',
                                'C13': 'voucher_id.partner_id.search_key${value or ""}',
                                'D13': 'voucher_id.partner_id${value and " ".join(list(filter(lambda l: l != False, [value.with_context(lang="th_TH").title.name, value.with_context(lang="th_TH").name]))) or ""}',
                                'E13': 'voucher_id.partner_id.category_id.name${value or ""}',
                                'F13': 'export_id.name${value or ""}',
                                'G13': 'count_invoice${value or ""}',
                                'H13': 'voucher_id.create_uid${value and value.with_context(lang="th_TH").display_name or ""}',
                                'I13': 'voucher_id${value and (value.payment_type == "transfer" and dict(direct="Direct", smart="Smart", oversea="Oversea")[value.transfer_type] or "Cheque") or ""}',
                                'J13': 'voucher_id.amount${value or ""}#{number_format=number}',
                                'K13': 'voucher_id.date${value or ""}#{number_format=date}',
                                'L13': 'export_id.date_value${value or ""}#{number_format=date}',
                                'M13': 'date_due${value or ""}#{number_format=date}',
                                'N13': "${'=?(M13)-?(L13)'}",
                                'O13': "${'=IF(?(M13)&gt;=?(L13),\"Yes\",\"No\")'}",
                            }
                        }
                    }
                }
            </field>
        </record>

        # SLA Employee
        <record id="xlsx_report_sla_employee" model="ir.attachment">
            <field name="res_model">xlsx.report.sla.employee</field>
            <field name="datas"></field>
            <field name="datas_fname">xlsx_report_sla_employee.xlsx</field>
            <field name="name">SLA Employee</field>
            <field name="parent_id" eval="ref('dir_account_reports')"/>
            <field name="description">
                {
                    '__EXPORT__': {
                        'SLA Employee Report': {
                            '_HEAD_': {
                                'A1': '${env.user.with_context(lang="en_US").company_id.partner_id.name}',
                                'B3': 'fiscalyear_start_id.name${value or ""}',
                                'D3': 'fiscalyear_end_id.name${value or ""}',
                                'B4': 'filter${value and dict(filter_no="No Filters", filter_date="Dates", filter_period="Periods")[value] or ""}',
                                'B5': 'period_start_id.name${value or ""}',
                                'D5': 'period_end_id.name${value or ""}',
                                'B6': 'date_start${value or ""}#{number_format=date}',
                                'D6': 'date_end${value or ""}#{number_format=date}',
                                'B7': 'user_ids${value and ", ".join([x.with_context(lang="th_TH").display_name for x in value]) or ""}',
                                'B8': 'source_document_type${value or ""}',
                                'B9': '${env.user.with_context(lang="th_TH").display_name}',
                                'B10': '${time.strftime("%d/%m/%Y")}#{number_format=date}',
                            },
                            'results': {
                                'A13': 'voucher_id.period_id.fiscalyear_id.name${value or ""}',
                                'B13': 'voucher_id.number${value or ""}',
                                'C13': 'invoice_id.source_document_id${value and value.display_name or ""}',
                                'D13': 'invoice_id.number${value or ""}',
                                'E13': 'invoice_id.comment${value or ""}',
                                'F13': 'invoice_id.partner_id.search_key${value or ""}',
                                'G13': 'invoice_id.partner_id${value and " ".join(list(filter(lambda l: l != False, [value.title_lang, value.with_context(lang="th_TH").name]))) or ""}',
                                'H13': 'invoice_id.partner_id.category_id.name${value or ""}',
                                'I13': 'export_id.name${value or ""}',
                                'J13': 'voucher_id.create_uid${value and value.with_context(lang="th_TH").display_name or ""}',
                                'K13': 'voucher_id${value and (value.payment_type == "transfer" and dict(direct="Direct", smart="Smart", oversea="Oversea")[value.transfer_type] or "Cheque") or ""}',
                                'L13': 'voucher_line_id.amount${value or ""}#{number_format=number}',
                                'M13': 'voucher_id.date${value or ""}#{number_format=date}',
                                'N13': 'export_id.date_value${value or ""}#{number_format=date}',
                                'O13': 'invoice_id.source_document_id${value and (value._table == "hr_expense_expense" and value.date_valid or "") or ""}#{number_format=date}',
                                'R13': 'voucher_id.move_ids${value and (value.mapped("match_import_id") and value.mapped("match_import_id").date_value or "") or ""}#{number_format=date}',
                                'P13': '${"=NETWORKDAYS(?(N13),?(O13),Holliday!B:B)"}',
                                'Q13': "${'=IF(?(P13)&lt;=5,\"Yes\",\"No\")'}",
                            }
                        }
                    }
                }
            </field>
        </record>

        # SLA Procurement
        <record id="xlsx_report_sla_procurement" model="ir.attachment">
            <field name="res_model">xlsx.report.sla.procurement</field>
            <field name="datas"></field>
            <field name="datas_fname">xlsx_report_sla_procurement.xlsx</field>
            <field name="name">SLA Procurement</field>
            <field name="parent_id" eval="ref('dir_account_reports')"/>
            <field name="description">
                {
                    '__EXPORT__': {
                        'SLA Procurement Report': {
                            '_HEAD_': {
                                'A1': '${env.user.with_context(lang="en_US").company_id.partner_id.name}',
                                'B3': 'fiscalyear_start_id.name${value or ""}',
                                'D3': 'fiscalyear_end_id.name${value or ""}',
                                'B4': 'filter${value and dict(filter_no="No Filters", filter_date="Dates", filter_period="Periods")[value] or ""}',
                                'B5': 'period_start_id.name${value or ""}',
                                'D5': 'period_end_id.name${value or ""}',
                                'B6': 'date_start${value or ""}#{number_format=date}',
                                'D6': 'date_end${value or ""}#{number_format=date}',
                                'B7': 'user_ids${value and ", ".join([x.with_context(lang="th_TH").display_name for x in value]) or ""}',
                                'B8': '${env.user.with_context(lang="th_TH").display_name}',
                                'B9': '${time.strftime("%d/%m/%Y")}#{number_format=date}',
                            },
                            'results': {
                                'A12': 'period_id.fiscalyear_id.name${value or ""}',
                                'B12': 'source_document_id${value and value.display_name or ""}',
                                'C12': 'number${value or ""}',
                                'D12': 'comment${value or ""}',
                                'E12': 'partner_id.search_key${value or ""}',
                                'F12': 'partner_id${value and " ".join(list(filter(lambda l: l != False, [value.with_context(lang="th_TH").title.name, value.with_context(lang="th_TH").name]))) or ""}',
                                'G12': 'partner_id.category_id.name${value or ""}',
                                'H12': 'validate_user_id${value and value.with_context(lang="th_TH").display_name or ""}',
                                'I12': 'payment_type${value and dict(transfer="Transfer", cheque="Cheque")[value] or ""}',
                                'J12': 'amount_total${value or ""}#{number_format=number}',
                                'K12': 'date_invoice${value or ""}#{number_format=date}',
                                'L12': 'date_receipt_billing${value or ""}#{number_format=date}',
                                'M12': '${"=NETWORKDAYS(?(K12),?(L12),Holliday!B:B)"}',
                                'N12': "${'=IF(?(P12)&lt;=4,\"Yes\",\"No\")'}",
                            }
                        }
                    }
                }
            </field>
        </record>

        # Supplier Receipt Follow Up
        <record id="xlsx_report_supplier_receipt_follow_up" model="ir.attachment">
            <field name="res_model">xlsx.report.supplier.receipt.follow.up</field>
            <field name="datas"></field>
            <field name="datas_fname">xlsx_report_supplier_receipt_follow_up.xlsx</field>
            <field name="name">Supplier Receipt Follow Up</field>
            <field name="parent_id" eval="ref('dir_account_reports')"/>
            <field name="description">
                {
                    '__EXPORT__': {
                        'Supplier Receipt Follow Up Report': {
                            '_HEAD_': {
                                'A1': '${env.user.with_context(lang="en_US").company_id.partner_id.name}',
                                'B3': 'fiscalyear_start_id.name${value or ""}',
                                'D3': 'fiscalyear_end_id.name${value or ""}',
                                'B4': 'filter${value and dict(filter_no="No Filters", filter_date="Dates", filter_period="Periods")[value] or ""}',
                                'B5': 'period_start_id.name${value or ""}',
                                'D5': 'period_end_id.name${value or ""}',
                                'B6': 'date_start${value or ""}#{number_format=date}',
                                'D6': 'date_end${value or ""}#{number_format=date}',
                                'B7': 'account_ids${value and ", ".join([x.code for x in value]) or ""}',
                                'B8': 'partner_ids${value and ", ".join([" ".join(list(filter(lambda l: l != False, [x.with_context(lang="th_TH").title.name, x.with_context(lang="th_TH").name]))) for x in value]) or ""}',
                                'B9': 'followup_receipt${value and dict(following="Following", received="Received")[value] or ""}',
                                'B10': '${env.user.with_context(lang="th_TH").display_name}',
                                'B11': '${time.strftime("%d/%m/%Y")}#{number_format=date}',
                            },
                            'results': {
                                'A14': 'voucher_id.partner_id.search_key${value or ""}',
                                'B14': 'voucher_id.partner_id${value and " ".join(list(filter(lambda l: l != False, [value.with_context(lang="th_TH").title.name, value.with_context(lang="th_TH").name]))) or ""}',
                                'C14': 'voucher_id.number${value or ""}',
                                'D14': 'voucher_id.create_uid${value and value.with_context(lang="th_TH").display_name or ""}',
                                'E14': 'voucher_id.date_value${value or ""}#{number_format=date}',
                                'F14': 'voucher_id.move_ids${value and (value.mapped("match_import_id") and value.mapped("match_import_id").date_value or "") or ""}#{number_format=date}',
                                'G14': 'voucher_id.narration${value or ""}',
                                'H14': 'voucher_id.amount${value or ""}',
                                'I14': 'voucher_id.payment_type${value and dict(cheque="Cheque", transfer="Transfer")[value] or ""}',
                                'J14': 'voucher_id.number_cheque${value or ""}',
                                'K14': 'voucher_id.supplier_bank_id${value and " ".join(list(filter(lambda l: l != False, [value.with_context(lang="th_TH").bank.name, value.with_context(lang="th_TH").bank_branch.name]))) or ""}',
                                'L14': 'voucher_id.supplier_bank_id.acc_number${value or ""}',
                                'M14': 'voucher_id.partner_id${value and " ".join(list(filter(lambda l: l != False, [value.street, value.street2, value.township_id.name, value.district_id.name, value.province_id.name, value.zip]))) or ""}',
                                'N14': 'invoice_line_id.invoice_id.number${value or ""}',
                                'O14': 'invoice_line_id.account_id.code${value or ""}',
                                'P14': 'invoice_line_id.activity_group_id.name${value or ""}',
                                'Q14': 'invoice_line_id.activity_id.name${value or ""}',
                                'R14': 'invoice_line_id.price_subtotal${value or ""}',
                                'S14': 'invoice_line_id.chartfield_id.code${value or ""}',
                                'T14': 'invoice_line_id.chartfield_id.name${value or ""}',
                                'U14': 'invoice_line_id${value and ((value.chartfield_id.type == "pj:" and (value.project_id.pm_employee_id and " ".join(list(filter(lambda l: l != False, [value.project_id.pm_employee_id.with_context(lang="th_TH").title_id.name, value.project_id.pm_employee_id.with_context(lang="th_TH").first_name, value.project_id.pm_employee_id.with_context(lang="th_TH").mid_name, value.project_id.pm_employee_id.with_context(lang="th_TH").last_name]))) or "")) or (value.chartfield_id.type == "cp:" and (value.invest_construction_id.pm_employee_id and " ".join(list(filter(lambda l: l != False, [value.invest_construction_id.pm_employee_id.with_context(lang="th_TH").title_id.name, value.invest_construction_id.pm_employee_id.with_context(lang="th_TH").first_name, value.invest_construction_id.pm_employee_id.with_context(lang="th_TH").mid_name, value.invest_construction_id.pm_employee_id.with_context(lang="th_TH").last_name]))) or ""))) or ""}',
                                'V14': 'invoice_line_id${value and (value.chartfield_id.type == "pj:" and value.project_id.external_pm or "") or ""}',
                            },
                            '_TAIL_0': {
                                'A14': '${"Total"}#{font=bold}',
                                'H14': '@{sum}#{font=bold;number_format=number;align=right}',
                                'R14': '@{sum}#{font=bold;number_format=number;align=right}',
                            }
                        }
                    }
                }
            </field>
        </record>

        # Output Tax Report
        <record id="xlsx_report_output_tax" model="ir.attachment">
            <field name="res_model">xlsx.report.output.tax</field>
            <field name="datas"></field>
            <field name="datas_fname">xlsx_report_output_tax.xlsx</field>
            <field name="name">Output Tax Report</field>
            <field name="parent_id" eval="ref('dir_account_reports')"/>
            <field name="description">
                {
                    '__EXPORT__': {
                        'Output Tax Report': {
                            '_HEAD_': {
                                'A1': '${env.user.with_context(lang="en_US").company_id.partner_id.name}',
                                'B3': 'calendar_period_id.calendar_name${value or ""}',
                                'B4': 'taxbranch_id${value and value.with_context(lang="th_TH").name or ""}',
                                'B5': '${env.user.with_context(lang="th_TH").display_name}',
                                'B6': '${time.strftime("%d/%m/%Y")}#{number_format=date}',
                            },
                            'results': {
                                'A10': 'invoice_date${value or ""}#{number_format=date}',
                                'B10': 'number_preprint${value or ""}',
                                'C10': 'partner_id${value and " ".join(list(filter(lambda l: l != False, [value.with_context(lang="th_TH").title.name, value.with_context(lang="th_TH").name]))) or ""}',
                                'D10': 'partner_id.vat${value or ""}',
                                'E10': 'partner_id.taxbranch${value and (value == "00000" and "Head Office" or value) or ""}',
                                'F10': 'base${value or ""}#{number_format=number}',
                                'G10': 'amount${value or ""}#{number_format=number}',
                                'H10': 'move_id.document_id${value and value._name == "account.invoice" and value.source_document_id and value.source_document_id._name == "sale.order" and value.source_document_id.workflow_process_id.name or ""}',
                                'I10': 'move_id.document_id${value and value._name == "account.invoice" and value.source_document_id and value.source_document_id._name == "sale.order" and value.source_document_id.workflow_process_id and value.source_document_id.name or ""}',
                                'J10': 'move_number${value or ""}',
                                'K10': 'move_id.document_id${value and value._name == "interface.account.entry" and value.name or ""}',
                                'L10': 'write_uid${value and value.with_context(lang="th_TH").display_name or ""}',
                            },
                            '_TAIL_0': {
                                'A10': '${"Total"}#{font=bold}',
                                'F10': '@{sum}#{font=bold;align=right;number_format=number}',
                                'G10': '@{sum}#{font=bold;align=right;number_format=number}',
                            }
                        }
                    }
                }
            </field>
        </record>

        # CD Receivable Confirmation
        <record id="xlsx_report_cd_receivable_confirmation" model="ir.attachment">
            <field name="res_model">xlsx.report.cd.receivable.confirmation</field>
            <field name="datas"></field>
            <field name="datas_fname">xlsx_report_cd_receivable_confirmation.xlsx</field>
            <field name="name">CD Receivable Confirmation</field>
            <field name="parent_id" eval="ref('dir_account_reports')"/>
            <field name="description">
                {
                    '__EXPORT__': {
                        'Receivable CD Confirmation Detail Report': {
                            '_HEAD_': {
                                'A1': '${env.user.with_context(lang="en_US").company_id.partner_id.name}',
                                'B3': 'date_report${value or ""}#{number_format=date}',
                                'B4': 'partner_ids${value and ", ".join([" ".join(list(filter(lambda l: l != False, [x.with_context(lang="th_TH").title.name, x.with_context(lang="th_TH").name]))) for x in value]) or ""}',
                                'B5': 'bank_ids${value and ", ".join([x.name for x in value]) or ""}',
                                'B6': '${env.user.with_context(lang="th_TH").display_name}',
                                'B7': '${time.strftime("%d/%m/%Y")}#{number_format=date}',
                            },
                            'results': {
                                'A10': 'loan_agreement_id.borrower_partner_id.search_key${value or ""}',
                                'B10': 'loan_agreement_id.borrower_partner_id${value and " ".join(list(filter(lambda l: l != False, [value.with_context(lang="th_TH").title.name, value.with_context(lang="th_TH").name]))) or ""}',
                                'C10': 'loan_agreement_id.sale_id.name${value or ""}',
                                'D10': 'loan_agreement_id.bank_id.bank_name${value or ""}',
                                'E10': 'loan_agreement_id.bank_id.bank_branch.name${value or ""}',
                                'F10': 'loan_agreement_id.name${value or ""}',
                                'G10': 'invoice_id.number${value or ""}',
                                'H10': 'invoice_id.amount_total${value or ""}',
                            },
                        },
                        'Receivable CD Confirmation Report': {
                            '_HEAD_': {
                                'A1': '${env.user.with_context(lang="en_US").company_id.partner_id.name}',
                                'B3': 'date_report${value or ""}#{number_format=date}',
                                'B4': 'partner_ids${value and ", ".join([" ".join(list(filter(lambda l: l != False, [x.with_context(lang="th_TH").title.name, x.with_context(lang="th_TH").name]))) for x in value]) or ""}',
                                'B5': 'bank_ids${value and ", ".join([x.name for x in value]) or ""}',
                                'B6': '${env.user.with_context(lang="th_TH").display_name}',
                                'B7': '${time.strftime("%d/%m/%Y")}#{number_format=date}',
                            },
                            '_BI_': {
                                'A10': {
                                    'df': 'Receivable CD Confirmation Detail Report',
                                    # Group by A, B, C, D, E, F and add Subtotal (so we use pivot)
                                    # By scripting, we need result = ...
                                    'oper_code': """
df = df[["A", "B", "C", "D", "E", "F", "H"]]
groupby = ["A", "B", "C", "D", "E", "F"]
sum_cols = ["H"]
result = pd.pivot_table(df, index=groupby,
                        values=sum_cols,
                        aggfunc=np.sum,
                        fill_value=0,
                        margins=True,
                        margins_name="Total")
                                    """,
                                },
                            },
                        },
                    }
                }
            </field>
        </record>

        # CD Receivable Planning
        <record id="xlsx_report_cd_receivable_planning" model="ir.attachment">
            <field name="res_model">xlsx.report.cd.receivable.planning</field>
            <field name="datas"></field>
            <field name="datas_fname">xlsx_report_cd_receivable_planning.xlsx</field>
            <field name="name">CD Receivable Planning</field>
            <field name="parent_id" eval="ref('dir_account_reports')"/>
            <field name="description">
                {
                    '__EXPORT__': {
                        'Receivable CD Planning Detail Report': {
                            '_HEAD_': {
                                'A1': '${env.user.with_context(lang="en_US").company_id.partner_id.name}',
                                'B3': 'fiscalyear_start_id.name${value or ""}',
                                'D3': 'fiscalyear_end_id.name${value or ""}',
                                'B4': 'filter${value and dict(filter_no="No Filters", filter_date="Dates", filter_period="Periods")[value] or ""}',
                                'B5': 'period_start_id.name${value or ""}',
                                'D5': 'period_end_id.name${value or ""}',
                                'B6': 'date_start${value or ""}#{number_format=date}',
                                'D6': 'date_end${value or ""}#{number_format=date}',
                                'B7': 'partner_ids${value and ", ".join([" ".join(list(filter(lambda l: l != False, [x.with_context(lang="th_TH").title.name, x.with_context(lang="th_TH").name]))) for x in value]) or ""}',
                                'B8': 'bank_ids${value and ", ".join([x.name for x in value]) or ""}',
                                'B9': '${env.user.with_context(lang="th_TH").display_name}',
                                'B10': '${time.strftime("%d/%m/%Y")}#{number_format=date}',
                            },
                            'results': {
                                'A13': 'loan_agreement_id.name${value or ""}',
                                'B13': 'loan_agreement_id.sale_id.name${value or ""}',
                                'C13': 'invoice_plan_id.installment${value or ""}',
                                'D13': 'invoice_plan_id.date_invoice${value or ""}#{number_format=date}',
                                'E13': 'fiscalyear_name${value or ""}',
                                'F13': 'q1${value or 0}',
                                'G13': 'q2${value or 0}',
                                'H13': 'q3${value or 0}',
                                'I13': 'q4${value or 0}',
                                'J13': 'amount_total${value or 0}',
                            },
                        },
                        'Receivable CD Planning Report': {
                            '_HEAD_': {
                                'A1': '${env.user.with_context(lang="en_US").company_id.partner_id.name}',
                                'B3': 'fiscalyear_start_id.name${value or ""}',
                                'D3': 'fiscalyear_end_id.name${value or ""}',
                                'B4': 'filter${value and dict(filter_no="No Filters", filter_date="Dates", filter_period="Periods")[value] or ""}',
                                'B5': 'period_start_id.name${value or ""}',
                                'D5': 'period_end_id.name${value or ""}',
                                'B6': 'date_start${value or ""}#{number_format=date}',
                                'D6': 'date_end${value or ""}#{number_format=date}',
                                'B7': 'partner_ids${value and ", ".join([" ".join(list(filter(lambda l: l != False, [x.with_context(lang="th_TH").title.name, x.with_context(lang="th_TH").name]))) for x in value]) or ""}',
                                'B8': 'bank_ids${value and ", ".join([x.name for x in value]) or ""}',
                                'B9': '${env.user.with_context(lang="th_TH").display_name}',
                                'B10': '${time.strftime("%d/%m/%Y")}#{number_format=date}',
                            },
                            '_BI_': {
                                'A13': {
                                    'df': 'Receivable CD Planning Detail Report',
                                    # Group by E and add Subtotal (so we use pivot)
                                    # By scripting, we need result = ...
                                    'oper_code': """
df = df[["E", "F", "G", "H", "I", "J"]]
groupby = ["E"]
sum_cols = ["F", "G", "H", "I", "J"]
result = pd.pivot_table(df, index=groupby,
                        values=sum_cols,
                        aggfunc=np.sum,
                        fill_value=0,
                        margins=True,
                        margins_name="Total")
                                    """,
                                },
                            },
                        },
                    }
                }
            </field>
        </record>

        # SLA Receipt
        <record id="xlsx_report_sla_receipt" model="ir.attachment">
            <field name="res_model">xlsx.report.sla.receipt</field>
            <field name="datas"></field>
            <field name="datas_fname">xlsx_report_sla_receipt.xlsx</field>
            <field name="name">SLA Receipt</field>
            <field name="parent_id" eval="ref('dir_account_reports')"/>
            <field name="description">
                {
                    '__EXPORT__': {
                        'SLA Receipt Report': {
                            '_HEAD_': {
                                'A1': '${env.user.with_context(lang="en_US").company_id.partner_id.name}',
                                'B3': 'fiscalyear_start_id.name${value or ""}',
                                'D3': 'fiscalyear_end_id.name${value or ""}',
                                'B4': 'filter${value and dict(filter_no="No Filters", filter_date="Dates", filter_period="Periods")[value] or ""}',
                                'B5': 'period_start_id.name${value or ""}',
                                'D5': 'period_end_id.name${value or ""}',
                                'B6': 'date_start${value or ""}#{number_format=date}',
                                'D6': 'date_end${value or ""}#{number_format=date}',
                                'B7': 'user_ids${value and ", ".join([x.with_context(lang="th_TH").display_name for x in value]) or ""}',
                                'B8': '${env.user.with_context(lang="th_TH").display_name}',
                                'B9': '${time.strftime("%d/%m/%Y")}#{number_format=date}',
                            },
                            'results': {
                                'A12': 'name${value or ""}',
                                'B12': 'validate_user_id${value and value.with_context(lang="th_TH").display_name or ""}',
                                'C12': 'date_accept${value or ""}#{number_format=date}',
                                'D12': 'receipt_date${value or ""}#{number_format=date}',
                                'E12': '${"=NETWORKDAYS(?(C12),?(D12),Holliday!B:B)"}',
                                'F12': "${'=IF(?(E12)&lt;=2,1,0)'}",
                                'G12': "${'=IF(?(E12)=3,1,0)'}",
                                'H12': "${'=IF(?(E12)&gt;3,1,0)'}",
                            },
                            '_TAIL_0': {
                                'A12': '${"Total"}#{font=bold}',
                                'E12': '@{sum}#{font=bold;align=right}',
                                'F12': '@{sum}#{font=bold;align=right}',
                                'G12': '@{sum}#{font=bold;align=right}',
                                'H12': '@{sum}#{font=bold;align=right}',
                            }
                        }
                    }
                }
            </field>
        </record>

        # CD Receivable Balance Sheet Summary
        <record id="xlsx_report_cd_receivable_balance_sheet_summary" model="ir.attachment">
            <field name="res_model">xlsx.report.cd.receivable.balance.sheet.summary</field>
            <field name="datas"></field>
            <field name="datas_fname">xlsx_report_cd_receivable_balance_sheet_summary.xlsx</field>
            <field name="name">CD Receivable Balance Sheet Summary</field>
            <field name="parent_id" eval="ref('dir_account_reports')"/>
            <field name="description">
                {
                    '__EXPORT__': {
                        'Receivable CD Balance Sheet Summary Report': {
                            '_HEAD_': {
                                'A1': '${env.user.with_context(lang="en_US").company_id.partner_id.name}',
                                'B3': 'fiscalyear_start_id.name${value or ""}',
                                'D3': 'fiscalyear_end_id.name${value or ""}',
                                'B4': 'filter${value and dict(filter_no="No Filters", filter_date="Dates", filter_period="Periods")[value] or ""}',
                                'B5': 'period_start_id.name${value or ""}',
                                'D5': 'period_end_id.name${value or ""}',
                                'B6': 'date_start${value or ""}#{number_format=date}',
                                'D6': 'date_end${value or ""}#{number_format=date}',
                                'B7': 'partner_ids${value and ", ".join([" ".join(list(filter(lambda l: l != False, [x.with_context(lang="th_TH").title.name, x.with_context(lang="th_TH").name]))) for x in value]) or ""}',
                                'B8': 'mou_ids${value and ", ".join([x.name for x in value]) or ""}',
                                'B9': 'account_ids${value and ", ".join([x.code for x in value]) or ""}',
                                'B10': '${env.user.with_context(lang="th_TH").display_name}',
                                'B11': '${time.strftime("%d/%m/%Y")}#{number_format=date}',
                            },
                            'balance_sheet_summary_results': {
                                'A14': 'borrower_partner_id.search_key${value or ""}',
                                'B14': 'borrower_partner_id${value and " ".join(list(filter(lambda l: l != False, [value.with_context(lang="th_TH").title.name, value.with_context(lang="th_TH").name]))) or ""}',
                                'C14': 'mou_id.name${value or ""}',
                                'D14': 'sale_id.name${value or ""}',
                                'E14': 'bank_id.bank${value and value.with_context(lang="th_TH").name or ""}',
                                'F14': 'bank_id.bank_branch${value and value.with_context(lang="th_TH").name or ""}',
                                'G14': 'name${value or ""}',
                                'H14': '${"=IFERROR(VLOOKUP(?(L14),brought_forward_report!A1:B5000,2,0),0)"}#{number_format=number}',
                                'I14': '${"=IFERROR(VLOOKUP(?(L14),received_report!A1:C5000,2,0),0)"}#{number_format=number}',
                                'J14': '${"=IFERROR(VLOOKUP(?(L14),received_report!A1:C5000,3,0),0)"}#{number_format=number}',
                                'K14': '${"=?(H14)+?(I14)-?(J14)"}#{number_format=number}',
                                'L14': 'id${value or ""}',
                            },
                            '_TAIL_0': {
                                'G14': '${"Total"}#{font=bold;align=right}',
                                'H14': '@{sum}#{font=bold;number_format=number;align=right}',
                                'I14': '@{sum}#{font=bold;number_format=number;align=right}',
                                'J14': '@{sum}#{font=bold;number_format=number;align=right}',
                                'K14': '@{sum}#{font=bold;number_format=number;align=right}',
                            }
                        },
                        'brought_forward_detail_report': {
                            'brought_forward_results': {
                                'A2': 'loan_agreement_id.id${value or ""}',
                                'B2': 'invoice_id${value and (value.type == "in_invoice" and value.amount_total or (-1) * value.amount_total) or 0}#{number_format=number}',
                            },
                        },
                        'brought_forward_report': {
                            '_BI_': {
                                'A2': {
                                    'df': 'brought_forward_detail_report',
                                    # Group by A. User will have to do subtotal themselves
                                    'oper_code': 'df[["A", "B"]].groupby(["A"]).sum()',
                                },
                            },
                        },
                        'received_detail_report': {
                            'received_results': {
                                'A2': 'loan_agreement_id.id${value or ""}',
                                'B2': 'invoice_id${value and (value.type == "in_invoice" and value.amount_total or 0) or 0}#{number_format=number}',
                                'C2': 'invoice_id${value and (value.type == "out_invoice" and value.amount_total or 0) or 0}#{number_format=number}',
                            },
                        },
                        'received_report': {
                            '_BI_': {
                                'A2': {
                                    'df': 'received_detail_report',
                                    # Group by A. User will have to do subtotal themselves
                                    'oper_code': 'df[["A", "B", "C"]].groupby(["A"]).sum()',
                                },
                            },
                        },
                    }
                }
            </field>
        </record>

        # CD Receivable Balance Sheet Detail
        <record id="xlsx_report_cd_receivable_balance_sheet_detail" model="ir.attachment">
            <field name="res_model">xlsx.report.cd.receivable.balance.sheet.detail</field>
            <field name="datas"></field>
            <field name="datas_fname">xlsx_report_cd_receivable_balance_sheet_detail.xlsx</field>
            <field name="name">CD Receivable Balance Sheet Detail</field>
            <field name="parent_id" eval="ref('dir_account_reports')"/>
            <field name="description">
                {
                    '__EXPORT__': {
                        'Receivable CD Balance Sheet Detail Report': {
                            '_HEAD_': {
                                'A1': '${env.user.with_context(lang="en_US").company_id.partner_id.name}',
                                'B3': 'fiscalyear_start_id.name${value or ""}',
                                'D3': 'fiscalyear_end_id.name${value or ""}',
                                'B4': 'filter${value and dict(filter_no="No Filters", filter_date="Dates", filter_period="Periods")[value] or ""}',
                                'B5': 'period_start_id.name${value or ""}',
                                'D5': 'period_end_id.name${value or ""}',
                                'B6': 'date_start${value or ""}#{number_format=date}',
                                'D6': 'date_end${value or ""}#{number_format=date}',
                                'B7': 'partner_ids${value and ", ".join([" ".join(list(filter(lambda l: l != False, [x.with_context(lang="th_TH").title.name, x.with_context(lang="th_TH").name]))) for x in value]) or ""}',
                                'B8': 'mou_ids${value and ", ".join([x.name for x in value]) or ""}',
                                'B9': 'account_ids${value and ", ".join([x.code for x in value]) or ""}',
                                'B10': '${env.user.with_context(lang="th_TH").display_name}',
                                'B11': '${time.strftime("%d/%m/%Y")}#{number_format=date}',
                            },
                            'results': {
                                'A14': 'partner_code${value or ""}',
                                'B14': 'partner_name${value or ""}',
                                'C14': 'mou${value or ""}',
                                'D14': 'brought_forward${value or ""}#{number_format=number}',
                                'E14': 'supplier_payment_number${value or ""}',
                                'F14': 'supplier_payment_posting_date${value or ""}#{number_format=date}',
                                'G14': 'supplier_payment_amount${value or ""}#{number_format=number}',
                                'H14': 'installment${value or ""}',
                                'I14': 'customer_invoice_number${value or ""}',
                                'J14': 'customer_invoice_posting_date${value or ""}#{number_format=date}',
                                'K14': 'customer_invoice_amount${value or ""}#{number_format=number}',
                                'L14': 'outstanding${value or ""}#{number_format=number}',
                            }
                        },
                    }
                }
            </field>
        </record>

        # Tax Exemption Report
        <record id="xlsx_report_tax_exemption_receipt" model="ir.attachment">
            <field name="res_model">xlsx.report.tax.exemption.receipt</field>
            <field name="datas"></field>
            <field name="datas_fname">xlsx_report_tax_exemption_receipt.xlsx</field>
            <field name="name">Tax Exemption Report</field>
            <field name="parent_id" eval="ref('dir_account_reports')"/>
            <field name="description">
                {
                    '__EXPORT__': {
                        'Tax Exemption Report': {
                            '_HEAD_': {
                                'A1': '${env.user.with_context(lang="en_US").company_id.partner_id.name}',
                                'B3': 'calendar_period_id.calendar_name${value or ""}',
                                'B4': 'taxbranch_id${value and value.with_context(lang="th_TH").name or ""}',
                                'B5': '${env.user.with_context(lang="th_TH").display_name}',
                                'B6': '${time.strftime("%d/%m/%Y")}#{number_format=date}',
                            },
                            'results': {
                                'A10': 'date_invoice${value or ""}#{number_format=date}',
                                'B10': 'number_preprint${value or ""}',
                                'C10': 'partner_id${value and " ".join(list(filter(lambda l: l != False, [value.title_lang, value.with_context(lang="th_TH").name]))) or ""}',
                                'D10': 'partner_id.vat${value or ""}',
                                'E10': 'partner_id.taxbranch${value and (value == "00000" and "Head Office" or value) or ""}',
                                'F10': 'amount_untaxed${value or ""}#{number_format=number}',
                                'G10': 'invoice_id.amount_tax${value or "-"}#{number_format=number}',
                                'H10': 'invoice_id.source_document_id${value and (value.workflow_process_id and value.workflow_process_id.name or "") or ""}',
                                'I10': 'invoice_id.source_document_id${value and (value.workflow_process_id and value.name or "") or ""}',
                                'J10': 'number${value or ""}',
                                'K10': 'document_origin${value or ""}',
                                'L10': 'validate_user_id${value and value.with_context(lang="th_TH").display_name or ""}',
                            },
                            '_TAIL_0': {
                                'A10': '${"Total"}#{font=bold}',
                                'F10': '@{sum}#{font=bold;align=right;number_format=number}',
                                'G10': '@{sum}#{font=bold;align=right;number_format=number}',
                            }
                        }
                    }
                }
            </field>
        </record>

        # Receivable Balance Before Due
        <record id="xlsx_report_receivable_before_due" model="ir.attachment">
            <field name="res_model">xlsx.report.receivable.before.due</field>
            <field name="datas"></field>
            <field name="datas_fname">xlsx_report_receivable_before_due.xlsx</field>
            <field name="name">Receivable Balance (Before Due) Report</field>
            <field name="parent_id" eval="ref('dir_account_reports')"/>
            <field name="description">
                {
                    '__EXPORT__': {
                        'Receivable Balance (Before Due) Report': {
                            '_HEAD_': {
                                'A1': '${env.user.with_context(lang="en_US").company_id.partner_id.name}',
                                'B3': 'before_due_date${value or 0}',
                                'B4': 'date_report${value or ""}#{number_format=date}',
                                'B6': 'system_ids.name${value or ""}',
                                'B7': '${env.user.with_context(lang="th_TH").display_name}',
                                'B8': '${time.strftime("%d/%m/%Y")}#{number_format=date}',
                            },
                            'results': {
                                'A11': 'move_line_id.partner_id.search_key${value or ""}',
                                'B11': 'move_line_id.partner_id${value and " ".join(list(filter(lambda l: l != False, [value.title_lang, value.with_context(lang="th_TH").name]))) or ""}',
                                'C11': 'move_line_id.move_id.name${value or ""}',
                                'D11': 'move_line_id.move_id.date_document${value or ""}#{number_format=date}',
                                'E11': 'move_line_id.move_id.document_id${value and value._name == "interface.account.entry" and value.name or ""}',
                                'F11': 'move_line_id.move_id.document_id${value and value._name == "interface.account.entry" and value.system_id.name or ""}',
                                'G11': 'move_line_id.move_id.narration${value or ""}',
                                'H11': 'move_line_id${value and (value.credit != 0 and (-1) * value.credit or value.debit) or 0}#{number_format=number}',
                                'I11': 'move_line_id.write_uid${value and value.with_context(lang="th_TH").display_name or ""}',
                                'J11': 'move_line_id.write_uid.id${value and env["hr.employee"].search([("user_id", "=", value)]).section_id.code or ""}',
                                'K11': 'move_line_id.write_uid.id${value and env["hr.employee"].search([("user_id", "=", value)]).section_id.name_short or ""}',
                            },
                            '_TAIL_0': {
                                'H11': '@{sum}#{font=bold;align=right;number_format=number}',
                            }
                        }
                    }
                }
            </field>
        </record>

        # Receivable Detail Report
        <record id="xlsx_report_receivable_detail" model="ir.attachment">
            <field name="res_model">xlsx.report.receivable.detail</field>
            <field name="datas"></field>
            <field name="datas_fname">xlsx_report_receivable_detail.xlsx</field>
            <field name="name">Receivable Detail Report</field>
            <field name="parent_id" eval="ref('dir_account_reports')"/>
            <field name="description">
                {
                    '__EXPORT__': {
                        'Receivable Detail Report': {
                            '_HEAD_': {
                                'A1': '${env.user.with_context(lang="en_US").company_id.partner_id.name}',
                                'B3': 'account_ids${value and ", ".join([x.code for x in value]) or ""}',
                                'B4': 'partner_ids${value and ", ".join([" ".join(list(filter(lambda l: l != False, [x.title.name, x.name]))) for x in value]) or ""}',
                                'B5': 'fiscalyear_start_id${value and value.name or ""}',
                                'E5': 'fiscalyear_end_id${value and value.name or ""}',
                                'B6': 'filter${value and dict(filter_no="No Filters", filter_date="Dates", filter_period="Periods")[value] or ""}',
                                'B7': 'period_start_id.name${value or ""}',
                                'E7': 'period_end_id.name${value or ""}',
                                'B8': 'date_start${value or ""}#{number_format=date}',
                                'E8': 'date_end${value or ""}#{number_format=date}',
                                'B9': 'start_doc_posting_date${value or ""}#{number_format=date;align=left}',
                                'E9': 'end_doc_posting_date${value or ""}#{number_format=date;align=left}',
                                'B10': 'start_doc_date${value or ""}#{number_format=date;align=left}',
                                'E10': 'end_doc_date${value or ""}#{number_format=date;align=left}',
                                'B11': 'move_ids${value and ", ".join([x.name for x in value]) or ""}',
                                'B12': 'system_ids.name${value or ""}',
                                'B13': '${env.user.display_name}',
                                'B14': '${time.strftime("%d/%m/%Y")}#{number_format=date;align=left}',
                            },
                            'results': {
                                'A17': 'invoice_move_line_id.partner_id.search_key${value or ""}',
                                'B17': 'invoice_move_line_id.partner_id${value and " ".join(list(filter(lambda l: l != False, [value.title.name, value.name]))) or ""}',
                                'C17': 'invoice_move_line_id.move_id.name${value or ""}',
                                'D17': 'invoice_move_line_id.move_id.document_id${value and (value._name == "interface.account.entry" and (value.type == "invoice" and value.system_id.name or "") or "") or ""}',
                                'E17': 'invoice_move_line_id.move_id.document_id${value and (value._name == "interface.account.entry" and (value.type == "invoice" and value.name or "") or "") or ""}',
                                'F17': 'invoice_move_line_id.move_id.date_document${value or ""}#{number_format=date}',
                                'G17': 'invoice_move_line_id.move_id.date${value or ""}#{number_format=date}',
                                'H17': 'invoice_move_line_id.invoice.date_due${value or ""}#{number_format=date}',
                                'I17': 'invoice_move_line_id.invoice.amount_untaxed${value or 0}#{number_format=number}',
                                'J17': 'invoice_move_line_id.invoice.amount_tax${value or 0}#{number_format=number}',
                                'K17': 'invoice_move_line_id${value and (value.credit != 0 and (-1) * value.credit or value.debit) or 0}#{number_format=number}',
                                'L17': 'invoice_move_line_id.currency_id.name${value or "THB"}',
                                'M17': 'invoice_move_line_id.invoice.tax_line${value and (value[0].tax_code_id.code or "") or ""}',
                                'N17': 'invoice_move_line_id.move_id.narration${value or ""}',
                                'O17': 'voucher_move_line_id.move_id.name${value or ""}',
                                'P17': 'voucher_move_line_id.move_id.document_id${value and (value._name == "interface.account.entry" and (value.type == "payment" and value.name or "") or "") or ""}',
                                'Q17': 'invoice_move_line_id.move_id.document_id${value and (value._name == "interface.account.entry" and (value.preprint_number or "") or (value._name == "account.voucher" and (value.number_preprint or ""))) or ""}',
                                'R17': 'voucher_move_line_id${value and (value.debit != 0 and (-1) * value.debit or value.credit) or 0}#{number_format=number}',
                                'S17': 'invoice_move_line_id.reconcile_id.name${value or ""}',
                                'T17': 'invoice_move_line_id.move_id.create_uid${value and value.with_context(lang="th_TH").display_name or ""}',
                                'U17': "${'=IF(?(S17)=\"\",\"Open\",\"Paid\")'}",
                            },
                            '_TAIL_0': {
                                'I17': '@{sum}#{font=bold;number_format=number}',
                                'J17': '@{sum}#{font=bold;number_format=number}',
                                'K17': '@{sum}#{font=bold;number_format=number}',
                                'R17': '@{sum}#{font=bold;number_format=number}',
                            }
                        }
                    }
                }
            </field>
        </record>

        # Registrar of Guarantee Report
        <record id="xlsx_report_registrar_of_guarantee" model="ir.attachment">
            <field name="res_model">xlsx.report.registrar.of.guarantee</field>
            <field name="datas"></field>
            <field name="datas_fname">xlsx_report_registrar_of_guarantee.xlsx</field>
            <field name="name">Registrar of Guarantee Report</field>
            <field name="parent_id" eval="ref('dir_account_reports')"/>
            <field name="description">
                {
                    '__EXPORT__': {
                        'Registrar of Guarantee Report': {
                            '_HEAD_': {
                                'A1': '${env.user.with_context(lang="en_US").company_id.partner_id.name}',
                                'B3': 'fiscalyear_start_id.name${value or ""}',
                                'D3': 'fiscalyear_end_id.name${value or ""}',
                                'B4': 'filter${value and dict(filter_no="No Filters", filter_date="Dates", filter_period="Periods")[value] or ""}',
                                'B5': 'period_start_id.name${value or ""}',
                                'D5': 'period_end_id.name${value or ""}',
                                'B6': 'date_start${value or ""}#{number_format=date}',
                                'D6': 'date_end${value or ""}#{number_format=date}',
                                'B7': 'reconcile_cond${value and dict(all="All", open_item="Open Items", reconciled="Reconciled")[value] or ""}',
                                'B8': 'account_code${value or ""}',
                                'B9': '${env.user.with_context(lang="th_TH").display_name}',
                                'B10': '${time.strftime("%d/%m/%Y")}#{number_format=date}',
                            },
                            'results': {
                                'A13': 'invoice_move_line_id.org_id.name_short${value or ""}',
                                'B13': 'invoice_move_line_id.period_id.fiscalyear_id.name${value or ""}',
                                'C13': 'invoice_move_line_id.move_id.name${value or ""}',
                                'D13': 'invoice_move_line_id.move_id.date_document${value or ""}#{number_format=date}',
                                'E13': 'invoice_move_line_id.move_id.date${value or ""}#{number_format=date}',
                                'F13': 'invoice_move_line_id.move_id.document_id${value and value._name == "interface.account.entry" and value.system_id.name or ""}',
                                'G13': 'invoice_move_line_id.move_id.document_id${value and value._name == "interface.account.entry" and value.name or ""}',
                                'H13': 'invoice_move_line_id.partner_id.search_key${value or ""}',
                                'I13': 'invoice_move_line_id.partner_id${value and " ".join(list(filter(lambda l: l != False, [value.with_context(lang="th_TH").title.name, value.with_context(lang="th_TH").name]))) or ""}',
                                'J13': 'voucher_move_line_id.move_id.narration${value or ""}',
                                'K13': '',
                                'L13': '',
                                'M13': '',
                                'N13': '',
                                'O13': 'invoice_move_line_id${value and value.credit - value.debit or ""}#{number_format=number}',
                                'P13': 'voucher_move_line_id${value and value.debit - value.credit or ""}#{number_format=number}',
                                'Q13': 'voucher_move_line_id.move_id.name${value or ""}',
                                'R13': 'invoice_move_line_id.reconcile_id.name${value or ""}',
                                'S13': 'invoice_move_line_id.write_uid${value and value.with_context(lang="th_TH").display_name or ""}',
                                'T13': "${'=IF(?(R13)=\"\",\"Open\",\"Cleared\")'}",
                            }
                        }
                    }
                }
            </field>
        </record>
    </data>
</openerp>
